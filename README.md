# 🍓 Celeste Smart Clipper (Celeste 智能回放剪辑脚本)

> [!IMPORTANT]
> 🤖 **AI 含量极高**
> 本项目代码由 AI 深度辅助编写。代码虽然能跑，但可能充满未知的玄学逻辑，主要供大家娱乐和参考。

配合 [VidCutter](https://gamebanana.com/mods/580133) 模组的输出日志，自动识别游戏内死亡/重生事件，一键从 OBS 回放缓存中精准截取通过片段。

告别海量素材堆积，告别手动剪辑痛苦！

## ✨ 主要功能
* **智能剪辑**：自动根据死亡/重生时间点，从 OBS 缓存中截取通关片段。
* **自动命名**：支持文件名自动包含地图名、房间名（需 VidCutter 支持）。
* **自动去重**：若新片段包含旧片段，自动清理冗余文件。
* **按键反馈**：支持操作提示音，盲操更安心。

## 📦 安装与配置

### 1. 前置要求
* **Celeste 游戏**：需安装 [**VidCutter**](https://gamebanana.com/mods/580133) Mod (用于生成日志)。
* [**OBS Studio**](https://obsproject.com/)：需开启 **回放缓存** (Replay Buffer)，建议设置时长 ≥ 300秒。

### 2. 脚本安装
1.  下载本仓库的 `CelesteSmartClipper.py`。
2.  下载 Releases 中的 `Python_Environment.zip` 并解压到一个固定位置（路径尽量无中文）。
     * 也可以选择自行搭建环境，注意obs不支持版本过高的Python
4.  **OBS 设置** -> **工具** -> **脚本** -> **Python 设置**：
    * 选择刚才解压的 Python 环境文件夹。
5.  回到 **脚本** 标签页，点击 `+` 号加载 `CelesteSmartClipper.py`。

### 3. 参数设置
* **Celeste 游戏根目录**：填写你的游戏安装路径。
* **OBS 热键绑定**：去 **设置 -> 热键** 搜索 `Celeste`，绑定以下三个关键按键：
    * `Celeste: 1. 标记本轮起点`
    * `Celeste: 2. 追溯上一轮起点`
    * `Celeste: 3. 剪辑通过片段`

---

## 🎮 使用流程

### 1. ⚔️ 受苦 (Play)
正常游玩，反复尝试直到通过当前房间。

### 2. 📍 标记 (Mark)
**在本面通过后、切版前**（或刚切入下一面画面稳定时），按下 **[标记键]**。
> 脚本会自动锁定“最近一次死亡时间”作为视频的起点。

### 3. 🎬 剪辑 (Clip)
在下一面站稳后，按下 **[剪辑键]**。
> 脚本会自动导出从“标记点”到“当前时间”的纯净通关视频。

---

## 🚑 急救指南 (FAQ)

| 场景/症状 | 解决方案 | 原理 |
| :--- | :--- | :--- |
| **手滑了**：通过后忘了按标记，切图后不小心又死了一次 | 复活后按 **[追溯]** → 再按 **[剪辑]** | 放弃最近一次死亡，回滚到上一次死亡点作为起点 |
| **被坑了**：复活点只有死过一次后才能站立 | 复活稳定后按 **[追溯]** | 同上 |
| **要留档**：捡到钥匙/超唐操作后死亡，想保留这段录像 | 复活后按 **[追溯]** | 将“捡到道具前的复活点”设为视频起点 |

> **☠️ 绝望时刻**：如果你在标记前死了3次以上... 脚本救不了你了，请手动导出 OBS 完整回放缓存自行剪辑。

---

## ⚠️ 注意事项
1.  **不要把脚本放进游戏 Mods 文件夹**：这是一个 OBS 脚本，不是游戏 Mod。
2.  **单个视频时长上限**：受限于 OBS 回放缓存的设置时长（建议设大一点，如 300秒+）。
3.  **剪辑起点的“提前量”现象（关键帧机制）**：由于本脚本采用FFmpeg的流式拷贝，视频的切割点必须依附于关键帧。因此，导出的片段开头可能会比你标记的时间点提前几秒（取决于 OBS 的关键帧间隔设置）。
    * 这是正常现象，能确保你的视频画质与原画完全一致且导出速度极快。
    * （若希望剪辑更精准，可在 OBS 输出设置中将“关键帧间隔”手动设为 2秒 或 1秒）。

---
*Created with ❤️ for Celeste Climbers.*
